设备、设备库和驱动
==

从前面的文档已经告诉我们，IOT-Tree的通道、设备相关规定。其中，设备驱动由通道设定，而通道下面的多个设备也由这个通道统一管理。这种结构符合自动化系统、物联网系统的实际部署拓扑结构。如通道可以对应一个现场总线，下面的设备也可以对应现场总线下面挂接的设备。

仔细分析我们可以发现，一个通道下面的设备，本质就是内在的相关属性和它包含的子孙节点和标签等资源。现实中，我们使用了某个厂家的同一种型号的多个设备，在IOT-Tree内部配置完成之后，大部分内容都是相同的（一些差异仅仅是设备地址属性和更新时间之类的）。而设备下面的标签（Tags）数据也相同。如果某个设备内部比较复杂，我们也可以在此设备下面定义单个设备UI，这个UI也是可以共用的。

因此，IOT-Tree对设备管理单独引入了一个设备库。这个设备库和具体项目无关，并且做了"设备库-分类-设备"三级管理机制，满足这个丰富多彩的设备世界。



## 1 设备定义 Device Definition


为了区分设备库中的设备和项目中使用的具体设备，我们把设备库中的设备称为设备定义。整个设备定义从本质上和具体项目中的设备节点基本相似，可以看成是项目树中的一颗枝条。这个设备枝条有自己的标签、子节点，甚至也可以有自己的UI（单个设备UI）。



在IOT-Tree中，设备定义有自己的编辑管理界面，具体请参考[设备定义(Device Definition)][defdev]。

[defdev]:./dev_def.md

## 2 设备库


在IOT-Tree登录之后管理主界面中，设备库"Device Library"可以管理本部署实例的所有设备库及内部的设备定义。由于支持导入导出功能，你可以很方便的新的部署环境中，导入你在其他项目中积累的设备定义。

点击某个设备库内，你可以管理分类——新增、修改删除等。在分类下面，你可以新增设备、修改设备名称或删除设备。详细内容请参考[设备库][dev_lib]。

其中，点击设备编辑按钮，就会弹出一个新的浏览器窗口，进入了这个设备定义的编辑界面。此编辑界面也是一颗设备树的组织方式，和项目中的设备配置类似。



具体请参考[设备定义(Device Definition)][defdev]。

[dev_lib]:./dev_lib.md

## 3 设备驱动Device Driver


当前，工业现场用到的RS485总线、以太网总线等，支持的各种设备。存在着大量的通信协议，设备驱动基本上是这些协议的实现，同时还考虑到工业现场的各种异常情况而做相关的应对措施。可以说，设备驱动是协议的实现，同时也是设备运行实际情况反馈的不断完善和打磨。

IOT-Tree中为了能够支持工业和物联网现场丰富多彩的设备，以接入链路、消息等模式为基础，设立设备驱动管理。这些设备驱动设置在和接入点(ConnPt)关联的通道(Channel)中。设备驱动以插件的方式定义，可以很方便的根据需要进行实现和添加。本章有专门针对不同设备驱动进行详细说明的内容。

由于项目中的设备在通道下面，而驱动在通道内部，从本质上设备定义可以和设备驱动分离。由此，IOT-Tree中的设备定义主要内部即是对应设备的数据组织和管理。每个数据项通过数据地址Address和驱动建立关系。已经达到了最轻的耦合，保持了最大的简洁性。





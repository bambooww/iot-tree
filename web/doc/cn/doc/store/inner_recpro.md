记录数据二次处理
==

从1.3版本开始，IOT-Tree支持内部时序段记录器（Internal timing segment recorder）功能。以此为基础，IOT-Tree还设计了数据二次处理的一个架构。

这个架构可以使得数据的二次处理器可以以插件的方式进行，可以随着业务的需要不断扩展。

## 1 二次数据处理架构

数据二次处理有单独的线程进行支持。

### 1.3 为什么数据处理器要基于记录进行

要分析处理数据的变化，很多情况下，只需要分析短时间之内的数据变化就可以。但一些特殊的应用场合，数据特殊变化（如突变）是相对于过去来说的。我们大多数工业场合，所谓突变可能是几分钟之内的，但我们不能保证另一个场合，突变过程可能会持续几天。因此，完全依赖短时间的内存中分析判断并不能涵盖全部情况。因此，我们的二次数据处理架构是基于记录的。

## 2 目前支持或规划的数据处理器

### 2.1 差值(D-Value)处理器

此处理器针对累积值的数据标签，可以以秒、分钟、小时和天四种时间间隔对记录进行差值计算并进行存储。这样，我们可以针对累积值的标签数据，进行每秒、每分钟、每小时和每天的值统计记录。

你可能会疑惑——为什么不支持星期、月和年呢？这是我们通过仔细分析斟酌的。如果你要显示每周、每月和每年的值，完全可以基于每天的差值记录进行简单查询就可以实现。

### 2.2 跳变(Jump Change)处理器(规划中)

此处理器可以对某个标签值的离散变化进行分析，并记录出跳变时的数据变化情况。如，某个开关量从off-on

### 2.3 突变(Value Mutation)处理器(规划中)

此处理器可以对某个连续变化的标签值进行分析，并记录发现出现突变时的数据变化情况。如，某个温度标签值从缓慢变化到突然快速上升的变化。

### 2.4 稳定(Value Stable)处理器(规划中)

此处理器可以对某个连续变化的标签值进行分析，并记录发现数据稳定时的情况。




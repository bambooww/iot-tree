节点：标签写入过滤器
==


<cn></cn><en></en>


此节点支持对标签的写入，并且具体写入哪个标签，由输入消息决定。因此，此节点要求输入的消息payload必须包含特定格式的JSON数据。

在节点设置中，可以限定哪些标签允许此节点写入。

由于标签写入可能涉及底层驱动和通信，会有一定的延迟，因此此节点还支持异步方式运行。




### 参数设置

双击可以打开节点参数设置对话框

#### 异步运行


勾选此项，节点内部的标签写入会以异步方式运行——也即是接收到输入消息之后，触发内部一个运行线程，这样可以避免写入时间过长影响前面节点的运行实时性。

<font color="red">注意：如果设置异步运行，则节点在运行过程中，会忽略所有输入的消息。</font>



#### 写入标签列表


选择输入相关的标签，用来说明此节点允许的写入标签。



### 输入消息负载(payload)格式

1. 写单个标签命令格式

```
"payload":{
    "cmd":"write_tag","cmd_ts":12312445345,"cmd_to":20000,
    "tag":"ch1.gg1.tag11",
    "value":true
}
```

"cmd":"write_tag" 代表了单个标签写入

"cmd_ts":123124453 代表了这个指令创建时间戳

"cmd_to":20000  代表了这个指令的过期时间（毫秒），如果当前时间和创建指令的时间戳跨度超过这个过期时间，则消息不被处理

"tag":"ch1.gg1.tag11" 标签路径

"value":true  写入值

2. 写多个标签命令格式

```
"payload":{
    "cmd":"write_tags","cmd_ts":12312445345,"cmd_to":20000,
    "tags":[
        {"delay":0,   "tag":"ch1.gg1.tag11","value":true},
        {"delay":2000,"tag":"ch1.gg1.tag11","value":false}
    ]
}
```

"cmd":"write_tags" 代表了多个标签写入

"cmd_ts":123124453 代表了这个指令创建时间戳

"cmd_to":20000  代表了这个指令的过期时间（毫秒），如果当前时间和创建指令的时间戳跨度超过这个过期时间，则消息不被处理

"tags":[] 具体按顺序写入标签内容,每个写入标签有如下内容：

　　"delay":2000  写入前延迟毫秒

　　"tag":"ch1.gg1.tag11" 标签路径

　　"value":true  写入值
